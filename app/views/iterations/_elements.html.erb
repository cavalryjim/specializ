<%= javascript_include_tag 'jquery.rating' %>

<div>
  <div id="elementDiv" align=right>
    <% if @iteration.active %>
	  <!---<input type="text" id="element_name" />--->
	  <button id="new_element_btn"> Add New Item </button>
    <% end %>
  </div>  
   
  <div align=left>
  Iteration: 
  <%= select_tag(:iteration_select, options_from_collection_for_select(@iterations, :id, :num, @iteration.id ), :disabled => !@topic_group.active) %>
  </div>
</div>

<%= form_tag(:controller => "users", :action => "rate_elements", :method => "post") do %>
  <div>
	<table id="rating_table" class="display"  >
	 <thead>
	  <tr>
		<th>Name</th>
	    <th>Rating</th>
<!-- jdavis: trying something 
		<th>Remove</th> 
-->
		<th>hidden</th>

		
	  </tr>
	 </thead>
	
	 <tbody>
		<% @suggested_elements.each do |element| %>
	      <tr>
			<td>
			  <% if !element.element_attributes.empty? %>
			    <%= image_tag 'details_open.png' %>
			  <% end %>
			  <%= best_in_place_if (@iteration.active), element, :name, :type => :input, :html_attrs => { :size => 60 } %>

			  <% if @iteration.last? %>
				<%= link_to '(delete?)', topic_group_iteration_element_path(@topic_group, @iteration, element), 
					:confirm => "Select 'OK' to delete. Any unsaved ratings may be lost.", :method => :delete%>
			  <% end %>
			  <% if element.has_attributes? %>
			    <%= render 'inner_details', :element => element %>
			  <% end %>	
			</td>

			<td>
			  <%= my_suggestion(@iteration.active) %>
			</td>
<!-- jdavis: trying something 
			<td><%= link_to 'Delete', topic_group_iteration_element_path(@topic_group, @iteration, element), :confirm => 'Are you sure?', :method => :delete%></td>

-->
			<td><%= element.name.upcase %></td>
		 </tr>

		<% end %>
		
		<% @elements.each do |element| %>
		  <tr>
		    <td>
			  <% if !element.element_attributes.empty? %>
			    <%= image_tag 'details_open.png' %>
			  <% end %>
			  <%=# link_to element, element, :remote => true, :action => "edit" 
%>
			  <%= best_in_place_if ((can? :manage, @topic_group) && @iteration.last?), element, :name, :type => :input, :html_attrs => { :size => 60 } %>

			  <% if element.has_attributes? %>
			    <%= render 'inner_details', :element => element %>
			  <% end %>			
			</td>
			<% score = element.score(current_user.id ,@iteration.id) %>
		
			<td id="rating" >
			  
				<%= radio_button_tag row_name(element.id), 1, score == 1, options = { :class => "jdstar", :disabled => !@iteration.active } %>
				<%= radio_button_tag row_name(element.id), 2, score == 2, options = { :class => "jdstar", :disabled => !@iteration.active } %>
				<%= radio_button_tag row_name(element.id), 3, score == 3, options = { :class => "jdstar", :disabled => !@iteration.active } %>
				<%= radio_button_tag row_name(element.id), 4, score == 4, options = { :class => "jdstar", :disabled => !@iteration.active } %>
				<%= radio_button_tag row_name(element.id), 5, score == 5, options = { :class => "jdstar", :disabled => !@iteration.active } %>
			 
			</td>
<!-- jdavis: trying something 
		    <td><%= link_to 'Delete', topic_group_iteration_element_path(@topic_group, @iteration, element), :confirm => 'Are you sure?', :method => :delete%></td>
			
-->
			<td><%= element.name.upcase %></td>

		  </tr>
			
		<% end %>
	 </tbody>
	</table>
	
  </div>
  
  <%= hidden_field_tag(:iteration_id, @iteration.id) %>
  <%= hidden_field_tag(:resubmit, @submitted) %>
  <div align='right'> 
	<%= submit_tag("Save List", :confirm => confirm_dialogue(@submitted), :disabled => !@iteration.active) %> 
  </div>
 
<% end %>
<% if false %> <!--JDavis: was @iteration.active -->
	<div align='left'> <button id="item_delete"> Remove Selected Item </button>	</div>
<% end %>



